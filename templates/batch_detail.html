{% extends "base.html" %}

{% block title %}Detalle Batch - Portal de Operaciones{% endblock %}

{% block content %}
<h2>Batch #{{ batch.batch_number }}</h2>

<div class="card">
    <div class="card-header">
        <h3>Información del Batch</h3>
    </div>
    <div class="card-body">
        <table class="table">
            <tr>
                <th>Batch Number:</th>
                <td>{{ batch.batch_number }}</td>
            </tr>
            <tr>
                <th>Hole ID:</th>
                <td>{{ batch.hole_id }}</td>
            </tr>
            <tr>
                <th>From (m):</th>
                <td>{{ batch.from_depth }}</td>
            </tr>
            <tr>
                <th>To (m):</th>
                <td>{{ batch.to_depth }}</td>
            </tr>
            <tr>
                <th>Metros Totales:</th>
                <td>{{ batch.to_depth - batch.from_depth }}</td>
            </tr>
            <tr>
                <th>Machine:</th>
                <td>{{ batch.machine }}</td>
            </tr>
            <tr>
                <th>Comentarios:</th>
                <td>{{ batch.comments or 'N/A' }}</td>
            </tr>
            <tr>
                <th>Estado:</th>
                <td><span class="badge badge-{{ batch.status }}">{{ batch.status }}</span></td>
            </tr>
            <tr>
                <th>Fecha Creación:</th>
                <td>{{ batch.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
            </tr>
            <tr>
                <th>Última Actualización:</th>
                <td>{{ batch.updated_at.strftime('%Y-%m-%d %H:%M') }}</td>
            </tr>
        </table>
    </div>
</div>

<div style="margin-top: 20px;">
    <a href="{{ url_for('edit_batch', batch_id=batch.id) }}" class="btn btn-warning">Editar</a>
    <a href="{{ url_for('batches_list') }}" class="btn btn-secondary">Volver a Lista</a>
    <form action="{{ url_for('delete_batch', batch_id=batch.id) }}" method="POST" style="display: inline;" onsubmit="return confirm('¿Está seguro de eliminar este batch?');">
        <button type="submit" class="btn btn-danger">Eliminar</button>
    </form>
</div>

{% if scan_data %}
<div class="card" style="margin-top: 20px;">
    <div class="card-header">
        <h3>Datos de Escaneo</h3>
    </div>
    <div class="card-body">
        <table class="table">
            <thead>
                <tr>
                    <th>Fuente</th>
                    <th>Archivo</th>
                    <th>From</th>
                    <th>To</th>
                    <th>Calidad</th>
                    <th>Tamaño</th>
                </tr>
            </thead>
            <tbody>
                {% for data in scan_data %}
                <tr>
                    <td>{{ data.source }}</td>
                    <td>{{ data.file_path }}</td>
                    <td>{{ data.depth_from }}</td>
                    <td>{{ data.depth_to }}</td>
                    <td>{{ data.scan_quality }}</td>
                    <td>{{ data.file_size }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endif %}

{% endblock %}
